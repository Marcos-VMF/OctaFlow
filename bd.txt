-- Criando o banco de dados
CREATE DATABASE IF NOT EXISTS octaflow_bd;
USE octaflow_bd;

CREATE TABLE empresas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(255) NOT NULL
);

CREATE TABLE sistemas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(255) NOT NULL,
    link_download VARCHAR(255)
);

CREATE TABLE empresa_sistemas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    empresa_id INT,
    sistema_id INT,
    FOREIGN KEY (empresa_id) REFERENCES empresas(id) ON DELETE CASCADE,
    FOREIGN KEY (sistema_id) REFERENCES sistemas(id) ON DELETE CASCADE
);

CREATE TABLE checklists (
    id INT AUTO_INCREMENT PRIMARY KEY,
    empresa_id INT,
    data DATE,
    ticket VARCHAR(50),
    nome_pre_formatacao VARCHAR(255),
    nome_pos_formatacao VARCHAR(255),
    usuario_antigo VARCHAR(255),
    usuario_novo VARCHAR(255),
    procedimento_inicial TEXT,
    sistema_operacional TEXT,
    backup TEXT,
    local_salvamento VARCHAR(255),
    FOREIGN KEY (empresa_id) REFERENCES empresas(id) ON DELETE CASCADE
);

CREATE TABLE checklist_sistemas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    checklist_id INT,
    sistema_id INT,
    FOREIGN KEY (checklist_id) REFERENCES checklists(id) ON DELETE CASCADE,
    FOREIGN KEY (sistema_id) REFERENCES sistemas(id) ON DELETE CASCADE
);


